<script>
function mod_thing(action, which, ...moreargs) {
  const who = document.getElementById("who").value.replace(' ','~');
  const eventname = document.getElementById("eventname").value;
  const data = {'who': who,
                'eventname': eventname};
  if (action === 'del') {
    // event, name, time
    data['del'] = which;
    // event just needs index
    data['index'] = moreargs[0];
    if (which !== 'event') {
      // event points to event for name or time
      data['delevent'] = moreargs[1];
      if (which === 'time') {
        // name for time
        data['delname'] = moreargs[2];
      }
    }
  }
  else if (action === 'add') {
    // event, name
    data['add'] = which;
    // new event
    if (which == 'event') {
      data['newname'] = document.getElementById("neweventname").value;
    }
    else { //if (which == 'name') {
      data['addnameto'] = moreargs[0];
      data['newname'] = document.getElementById(moreargs[0] + "-name").value;
    }
  }
  fetch('availability.php', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    },
    body: new URLSearchParams(data),
  })
  .then(response => response.text())
  .then(responseText => {
    const parser = new DOMParser();
    const doc = parser.parseFromString(responseText, 'text/html');
    const newcontent = doc.getElementById('pagecontents');
    if (newcontent) {
      document.getElementById('pagecontents').innerHTML
        = newcontent.innerHTML;
    }
    else {
      console.log("Updated contents not found in response");
    }
  })
  .catch(error => console.error('Error:', error));
}
</script>
<!-- CSS -->
<link rel="stylesheet" href="/res/date-picker.css" />
<div id="pagecontents">
ERRORMSG
EVENTLIST
<h4>New event:</h4>
<ul type="none">
<li>
<input id="neweventname" type="text" placeholder="eventname"/>
&nbsp;&nbsp;
<button onclick="mod_thing('add', 'event')">âž•</button>
</li>
</ul>
<hr width="50%" color="#008A00" align="left" />
</div>
<input id="who" type="hidden" value="WHO"/>
<input id="eventname" type="hidden" value="EVENTNAME"/>
